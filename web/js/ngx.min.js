/*!
 * ramsondon.github.io - ramsondon.github.io v1.0.0 (https://ramsondon.github.io)
 * Copyright 2017 -2017 Matthias Schmid
 * Licensed under MIT
 */
if(_&&"undefined"!=typeof _||(_={}),"registerElement"in document)var ngxApp=document.registerElement("ngx-app"),ngxInclude=document.registerElement("ngx-include");_.ngx=function(){var e=function(){this.base_route="",this.wait_cache_freq=0,this.model_cache={mark:{},cache:{}},this.tpl_cache={mark:{},cache:{}},this.ready_listeners={}};return e.prototype.get=function(e,t){return new Promise(function(n,i){var r=this.base_route+e;fetch(r,{method:"GET"}).then(function(e){return 200!==e.status?void console.error("Error Report","Status Code: "+e.status,e.statusText):void e[t]().then(function(e){n(e)}.bind(this))}.bind(this))["catch"](function(e){i(e)}.bind(this))}.bind(this))},e.prototype.toKey=function(e){return e.replace(new RegExp("[/.-]","g"),"_")},e.prototype.waitCache=function(e,t){return new Promise(function(n,i){var r=0,c=function(){r>0&&t in e?(clearTimeout(r),r=0,n(t)):r=setTimeout(c,this.wait_cache_freq)}.bind(this);r=setTimeout(c,this.wait_cache_freq)}.bind(this))},e.prototype.render=function(e,t,n,i){var r=function(e){var r=document.createElement("script");r.type="text/x-ngx-tpl",r.innerHTML=e,n.appendChild(r),n.innerHTML=_.template(n.innerHTML)(t),n.innerHTML=n.querySelector("script").innerHTML,this.include(n.querySelectorAll("ngx-include")),_.isString(i)&&i in this.ready_listeners&&this.ready_listeners[i]()}.bind(this);this.cacheResource(e,this.tpl_cache,"text").then(function(e){r(this.tpl_cache.cache[e])}.bind(this))["catch"](function(e){console.warn(e)})},e.prototype.cacheResource=function(e,t,n){return new Promise(function(i,r){var c=this.toKey(e);c in t.mark?this.waitCache(t.cache,c).then(function(e){i(e)}.bind(this)):(t.mark[c]=e,this.get(e,n).then(function(e){t.cache[c]=e,i(c)}))}.bind(this))},e.prototype.parseInclude=function(e){return{model:e.getAttribute("x-model"),template:e.getAttribute("x-template"),listener:e.getAttribute("x-tplready")}},e.prototype.include=function(e){var t=function(e,t,n){this.render(e.template,{ngxModel:t},n,e.listener)}.bind(this);_.forEach(e,function(e,n){var i=this.parseInclude(e);if(i.model)try{t(i,this.readAssignment(i.model),e)}catch(r){this.cacheResource(i.model,this.model_cache,"json").then(function(n){t(i,this.model_cache.cache[n],e)}.bind(this))["catch"](function(e){console.warn(e)})}else t(i,null,e)}.bind(this))},e.prototype.nl2br=function(e,t){if(_.isString(e)){var n=t||"undefined"==typeof t?"<br />":"<br>";return(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+n+"$2")}return e},e.prototype.assign=function(e){return _.escape(JSON.stringify(e))},e.prototype.readAssignment=function(e){return JSON.parse(_.unescape(e))},e.prototype.ngx=function(){var e=document.querySelectorAll("ngx-app");_.forEach(e,function(e,t){this.include(e.querySelectorAll("ngx-include"))}.bind(this))},e.prototype.base=function(e){return this.base_route=e,this},e.prototype.xtplready=function(e,t){if(_.isObject(e)&&_.isUndefined(t))for(var n in e)this.xtplready(n,e[n]);else _.isString(e)&&_.isFunction(t)&&(this.ready_listeners[e]=t);return this},e.prototype.require=function(e,t){return function(e,n,i){var r,c=i.replace(new RegExp("[/.:]","g"),"_"),o=e.getElementsByTagName(n)[0];e.getElementById(c)||(r=e.createElement(n),r.id=c,r.src=i,o.parentNode.insertBefore(r,o),r.readyState?r.onreadystatechange=function(){"loaded"!==r.readyState&&"complete"!==r.readyState||(r.onreadystatechange=null,t())}:r.onload=t)}(document,"script",e)},e.prototype.start=function(){var e=function(){this.ngx()}.bind(this);return"fetch"in window?e():this.require("https://cdnjs.cloudflare.com/ajax/libs/fetch/2.0.3/fetch.min.js",e),this},new e}();